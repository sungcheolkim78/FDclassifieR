---
title: "check_functions"
author: "Sungcheol Kim"
date: "1/22/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(FDclassifieR)
library(ggplot2)
library(latex2exp)
```

## lambda function

```{r}
lambda.auc(0.95, N=1000, rho=0.97, full=TRUE)
```


```{r}
auclist <- (2:48)*0.01 + 0.5
rholist <- (2:18)*0.05
N <-1000

res <- data.table()

for (a in auclist) {
  for (r in rholist) {
    temp <- lambda.auc(a, N=N, rho=r, full=TRUE)
    res <- rbind(res, temp)
  }
}

res
```

```{r}
g1 <- ggplot(data=res) + geom_point(aes(x=auc, y=-l1/(l2*N), color=rho)) + theme_classic() + 
  xlab('AUC') + ylab(TeX('$\\mu/N$'))
#ggsave('lambda_auc_l1.pdf', width=6)
g1
```

```{r}
ggplot(data=res) + geom_point(aes(x=auc, y=l10, color=rho)) + theme_classic() + 
  xlab('AUC') + ylab(TeX('$\\lambda_1$'))
#ggsave('lambda_auc_l1.pdf', width=6)
```

```{r}
g2 <- ggplot(data=res) + geom_point(aes(x=auc, y=N*l2, color=rho)) + theme_classic() +
  xlab('AUC') + ylab(TeX('$N \\beta$'))
#ggsave('lambda_auc_l2.pdf', width=6)
g2
```

```{r}
ggplot(data=res) + geom_point(aes(x=auc, y=l20, color=rho)) + theme_classic() +
  xlab('AUC') + ylab('Lambda_2')
#ggsave('lambda_auc_l2.pdf', width=6)
```

```{r}
g3 <- ggplot(data=res) + geom_point(aes(x=auc, y=rs, color=rho)) + theme_classic() +
  xlab('AUC') + ylab('R*')
#ggsave('lambda_auc_rs.pdf', width=6)
g3
```

```{r}
g4 <- ggplot(data=res) + geom_point(aes(x=rho, y=-l1/(N*l2), color=auc)) + theme_classic() + 
  xlab(TeX('$\\rho')) + ylab(TeX('$\\mu / N$'))
g4
```

```{r}
g5 <- ggplot(data=res) + geom_point(aes(x=rho, y=N*l2, color=auc)) + theme_classic() + 
  xlab(TeX('$\\rho')) + ylab(TeX('$N \\beta'))
g5
```

```{r}
library(ggpubr)

g <- ggarrange(g1, g2, g3, g4, g5, labels=c("A", "B", "C", "D", "E"), ncol=3  , nrow=2)
ggsave("lambdas.pdf", width=14, height=8, dpi=300)
```

```{r}
g <- ggarrange(g2, g1, g5, g4, labels=c("A", "B", "C", "D"), ncol=2  , nrow=2)
ggsave("betamu_relation.pdf", width=8, height=6, dpi=300)
g
```

